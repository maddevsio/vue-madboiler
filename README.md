# Vue Mad Boiler(vue - 2.6.10)

При старте проекта на vue, постоянно сталкивался с тем, что приходилось снова и снова настраивать стор, добавлять базовую струкруту стилей, искать пакет иконок, настраивать нормально линтер и тд. Это отнимало достаточно времени.
Что уж говорить о человеке, который только начал копаться во всем в этом?! Там бывает и недели мало, чтобы собрать это всё.

Vue Mad Boiler - поможет избавить суеты, дав готовый, настроенный проект.

## Содержание

**[1. Запуск проекта](#запуск-проекта)**

  * [Через докер](#функционал-jwt-token)
  * [Без докера](#настройка-sentry)

**[2. Фичи](#фичи)**

  * [Функционал JWT Token](#функционал-jwt-token)
  * [Sentry](#sentry)
  * [Gitlab pages](#gitlab-pages)
  * [Генерация ковредж баджей для юнит тестов](#генерация-ковредж-баджей-для-юнит-тестов)

**[3. Документирование компонентов](#документирование-компонентов)**

**[4. Тестирование проекта](#тестирование-проекта)**

**[5. Проверка, форматирование кода](#проверка,-форматирование-кода)**

  * [Линтер](#линтер)
  * [Форматирование кода](#форматирование-кода)

**[6. Запуск проекта на продакшне](#запуск-проекта-на-продакшне)**


## Запуск проекта

Запускаем проект для разработки

```bash
npm run docker:dev
```
После того как докер соберет контейнер, сайт будет доступер по ссылке http://localhost:8080/ 

Запускаем проект на продакшне

```bash
npm run docker:prod
```

## Фичи

* Пример настроенного стора, где применяется модульный подход
* Очень злой линтер. Поругает за стили, верстку и скрипты
* Само собой тесты, которые генерят отчет о покрытии кода
* Готовая структура папок. Не нужно ничего придумывать
* Очень крутой пакет Material иконок
* Vuetify - фрэимворк готовых ui элементов
* Базовая структура scss стилей
* Пример директивы, которая добавляет анимацию волны для кнопок
* Настройка мультиязычности.
* Привер сервиса для работы с localstorage
* Настройки роутера, + middleware

### Функционал JWT Token 

Для работы с JWT Token использован HTTP client axios (https://www.npmjs.com/package/axios).

Функционал реализован в файле /api/config.js

REFRESH_URL - эндпоинт по которому будет происходить запрос на обновление Access-token
RESPONSE_ACCESS_PARAM - название ключа по которому Access token будет сохраняться в local storage
RESPONSE_REFRESH_PARAM - название ключа по которому Refresh token будет сохраняться в local storage
DEFAULT_URL - Дефолтный URL по которому будет производиться запрос в случае если process.env.REACT_APP_API_URL будет пустой

Описание:
Access-token — это токен, который предоставляет доступ его владельцу к защищенным ресурсам сервера
Refresh-token — это токен, позволяющий клиентам запрашивать новые access-токены по истечении их времени жизни.

1. Клиент проходит аутентификацию в приложении
2. В случае успешной аутентификации сервер отправляет клиенту access- и refresh-токены, которые сохраняются в Local Storage по ключам RESPONSE_ACCESS_PARAM и RESPONSE_REFRESH_PARAM
3. При дальнейшем обращении к серверу клиент использует access-токен. Сервер проверяет токен на валидность и предоставляет клиенту доступ к ресурсам
4. В случае, если access-токен становится не валидным, клиент отправляет refresh-токен (по URL указанному в REFRESH_URL), в ответ на который сервер предоставляет два обновленных токена. (Которые обновляются в Local Storage)
5. В случае, если refresh-токен становится не валидным, то происходит удлания токенов из Local Storage и клиент опять должен пройти процесс аутентификации


Имеются методы:
1. queryGet - Используется для get запросов серверу, где первым параметром отправляется URL, вторым параметры запроса
queryGet('/some-url', {query: 1})

2. queryPost - Используется для post запросов серверу, где первым параметром отправляется URL, вторым данные передаваемые на сервер, третьим параметры запроса
queryPost = ('/some-url', {data: 'some_data'}, {query: 1})

Возможно добавление собственных запросов, либо создать новый instance axios.create.

### Sentry

Sentry - сервис для удаленного мониторинга ошибок в веб приложениях.

#### Первым делом

1. Идём на сайт https://sentry.io и авторизуемся
2. Создаём новый проект https://docs.sentry.io/product/sentry-basics/guides/integrate-frontend/create-new-project/
3. После этого шага, у вас в распоряжении окажется dns url, который добавим в настройках в файле [main.js](./src/main.js)
4. Перезапускаем проект. По идеи все настроено и готово к отлову ошибок.  

#### Параметры

* dns - урл на который будут отправляться ошибки. Его получите при создании нового проекта в Sentry 
* tracesSampleRate - количество отправляемых ошибок в процентном соотношении от 0 до 1. Если нужно отправлять 40% транзакций - укажите 0.4

## Документирование компонентов

Проект с хорошо задокументированным кодом, в дальнейшем обеспечит более низкий порог входа для новых разработчиков. Вот пример доки для [vuetify button](https://vuetifyjs.com/en/api/v-btn/)

[@vuedoc/md](https://www.npmjs.com/package/@vuedoc/md) библиотека, которую будем использовать для документирования компонентов.

Чтобы можно было вызвать команду `vuedoc.md`, нужно обязательно установить этот пакет глобально.

Возможно понадобится использовать команду `sudo`, чтобы дать права на установку пакета глобально. 

```bash
sudo npm install --global @vuedoc/parser @vuedoc/md
```

Теперь, мы можем документировать компоненты.

Вот несколько примеров https://gitlab.com/vuedoc/md/-/tree/master/test/fixtures

После того, как описали один и компонентов, можно запускать команду и смореть результат. Только не забудьте поправить команду под вашу структуру файлов и папок.

```bash
vuedoc.md src/components/COMPONENT_NAME.vue --output docs/components
```
